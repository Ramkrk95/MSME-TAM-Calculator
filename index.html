<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSME TAM Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        h1, h2 {
            text-align: center;
        }
        input, select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #tamResult {
            margin-top: 20px;
            font-weight: bold;
            color: #333;
            text-align: center;
        }
        .disclaimer {
            margin-top: 20px;
            font-size: 14px;
            color: #555;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>MSME TAM Calculator</h1>
        <p>
            Are you developing a product or solution for the MSME (Micro, Small, and Medium Enterprises) sector in India? This calculator is designed to help you estimate the total addressable market (TAM) by providing insights into the number of companies that have already embraced digital tools and are potentially willing to invest in the software you are planning to build.
        </p>
        <h2>Instructions</h2>
        <ul>
            <li>Identify the number of MSMEs that are digitally active and open to adopting new technologies.</li>
            <li>Understand market potential for your product or solution.</li>
            <li>Make informed decisions to effectively target your audience.</li>
        </ul>
        <p>Simply fill in the required details to discover the potential market size for your innovative product or solution. Letâ€™s get started!</p>

        <!-- Tally.so Form Embed -->
        <iframe src="https://tally.so/embed/nPYYoQ?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1" width="100%" height="500" frameborder="0" marginheight="0" marginwidth="0" title="Tally Form"></iframe>

        <!-- Section to display the TAM result -->
        <div id="tamResult"></div>

        <!-- Disclaimer -->
        <div class="disclaimer">
            <p><strong>Disclaimer:</strong> The TAM calculated here is a high-level estimate based on limited data inputs. 
            For a more accurate and closer TAM, additional filtering such as company size, geographic location, revenue brackets, 
            and technology adoption levels should be considered. This tool provides a preliminary market size, and further detailed 
            analysis is recommended to refine your strategy.</p>
        </div>
    </div>

    <script>
        // Listen for form submission from Tally form
        window.addEventListener('message', async function(event) {
            // Capture the form data from the Tally iframe
            if (event.data && event.data.type === 'TallyFormSubmit') {
                // Extract email, industry, price, name, etc.
                var email = event.data.email;
                var industryProductType = event.data.industryProductType;
                var price = event.data.price;
                var name = event.data.name || 'Anonymous';

                // Send the form data to your backend to calculate TAM
                try {
                    const response = await fetch('https://msme-tam-calculator.vercel.app/api/calculate-tam', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            email: email,
                            industryProductType: industryProductType.trim(),
                            price: price,
                            name: name,
                        }),
                    });

                    const result = await response.json();

                    if (response.ok) {
                        document.getElementById('tamResult').innerHTML = `
                            <p>The Total Addressable Market (TAM in INR) is: ${result.tam}</p>
                            <p>Relevant Companies: ${result.relevantCompanies}</p>
                            <p>Pricing (in INR): ${result.pricing}</p>
                        `;
                    } else {
                        document.getElementById('tamResult').innerHTML = 'Could not calculate TAM. Please check your input.';
                    }
                } catch (error) {
                    document.getElementById('tamResult').innerHTML = 'An error occurred while calculating TAM. Please try again.';
                }
            }
        }, false);
    </script>
</body>
</html>
